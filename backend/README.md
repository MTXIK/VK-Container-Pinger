# Сервис Backend

Сервис Backend обеспечивает RESTful API для работы с данными пингов контейнеров. Он принимает запросы на получение, добавление и удаление записей о пинге, взаимодействует с базой данных PostgreSQL для хранения информации и использует Redis для кэширования. Кроме того, сервис запускает Kafka consumer для приёма сообщений с результатами пингов и сохранения их в базу.

## Переменные окружения

- **DB_HOST** – адрес сервера базы данных (например, `postgres`).
- **DB_USER** – имя пользователя базы данных (например, `postgres`).
- **DB_PASSWORD** – пароль пользователя базы данных (например, `mypassword`).
- **DB_NAME** – имя базы данных (например, `mydb`).
- **KAFKA_BROKER** – адрес Kafka-брокера (например, `kafka:9092`).
- **REDIS_ADDR** – адрес Redis-сервера (например, `redis:6379`).
- **PORT** – порт, на котором работает сервис (например, `8080`).

## Основные функции

- **RESTful API:**  
  - `GET /api/pings` — возвращает список записей о пингах.
  - `POST /api/ping` — добавляет (или обновляет) запись о пинге.
  - `DELETE /api/pings/old` — удаляет устаревшие записи.

- **Kafka Consumer:**  
  Сервис слушает Kafka-топик `ping-results` и сохраняет поступающие сообщения в базу данных, обновляя кэш в Redis.

- **Кэширование:**  
  Redis используется для кэширования ответов API, что позволяет уменьшить нагрузку на базу данных.

- **Очистка данных:**  
  Периодически (например, раз в 24 часа) производится удаление устаревших записей из базы.

## Зависимости

- **PostgreSQL** – хранение данных.
- **Redis** – кэширование.
- **Kafka** – обмен сообщениями.
- **Gin** – фреймворк для создания API.
